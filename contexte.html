<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Contexte environnemental - Plantouille express</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script defer src="ui.js"></script>
  <script defer src="contexte.js"></script>
  <style>
    body{ margin:0; padding:0; display:flex; flex-direction:column; min-height:100vh; }
    
    /* Contenu principal */
    .main-content { flex: 1; padding: 1.5rem; max-width: 900px; margin: 0 auto; width: 100%; }
    h1 { color: var(--primary); margin: 0 0 1.5rem; font-size: 1.6rem; text-align: center; }
    
    /* Options de localisation */
    .location-options { display: flex; flex-direction: column; gap: 1rem; margin-bottom: 2rem; }
    .location-card { background: var(--card); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .location-card h2 { font-size: 1.2rem; color: var(--primary); margin: 0 0 1rem; }
    
    .action-button { padding: 12px 20px; background: var(--primary); color: white; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; transition: all 0.3s; width: 100%; }
    .action-button:hover { background: #2e7d32; transform: scale(1.02); }
    .action-button:disabled { background: #ccc; cursor: not-allowed; transform: none; }
    
    /* Carte interactive */
    #map-container { display: none; margin-top: 1rem; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    #map { height: 400px; width: 100%; }
    
    /* Coordonn√©es s√©lectionn√©es */
    .coordinates-display { display: none; margin-top: 1rem; padding: 1rem; background: rgba(56, 142, 60, 0.1); border-radius: 6px; text-align: center; }
    .coordinates-display span { font-weight: 600; color: var(--primary); }
    
    /* R√©sultats */
    .results-section { display: none; margin-top: 2rem; }
    .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-top: 1rem; }
    .result-card { background: var(--card); border-radius: 8px; padding: 1rem; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .result-card h3 { color: var(--primary); margin: 0 0 0.5rem; font-size: 1.1rem; }
    .result-card a { display: inline-block; margin-top: 0.5rem; color: var(--primary); text-decoration: none; }
    .result-card a:hover { text-decoration: underline; }
    
    /* Message d'instruction sur la carte */
    .map-instruction { display: none; position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(0, 0, 0, 0.7); color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; z-index: 1000; pointer-events: none; }
    
    @media (prefers-color-scheme:dark) {
      .coordinates-display { background: rgba(56, 142, 60, 0.2); }
      .map-instruction { background: rgba(255, 255, 255, 0.15); }
    }
  </style>
</head>
<body>
  <!-- Navigation par onglets -->
  <nav class="tabs-container">
    <div class="tabs">
      <button class="tab" onclick="window.location.href='index.html'">Identification</button>
      <button class="tab active">Contexte environnemental</button>
      <button class="tab" onclick="window.location.href='notebook.html'">Carnet</button>
    </div>
  </nav>

  <div class="main-content">
    <h1>Contexte environnemental</h1>
    
    <div class="location-options">
      <!-- Option 1: G√©olocalisation -->
      <div class="location-card">
        <h2>üìç Utiliser ma position actuelle</h2>
        <button class="action-button" id="use-geolocation">
          Utiliser ma localisation
        </button>
      </div>
      
      <!-- Option 2: S√©lection sur carte -->
      <div class="location-card">
        <h2>üó∫Ô∏è Choisir un endroit sur la carte</h2>
        <button class="action-button" id="choose-on-map">
          Ouvrir la carte
        </button>
        
        <div id="map-container">
          <div class="map-instruction" id="map-instruction">
            Cliquez longuement pour s√©lectionner un point
          </div>
          <div id="map"></div>
        </div>
        
        <div class="coordinates-display" id="coordinates-display">
          Coordonn√©es s√©lectionn√©es : 
          <span id="selected-coords">--</span>
        </div>
        
        <button class="action-button" id="validate-location" style="display:none; margin-top:1rem;">
          Valider cette localisation
        </button>
      </div>
    </div>
    
    <!-- Indicateur de chargement -->
    <div class="loading loading-spinner" id="loading"></div>
    
    <!-- Section des r√©sultats -->
    <div class="results-section" id="results-section">
      <h2>Ressources environnementales</h2>
      <p style="margin-bottom: 1rem; color: #666;">
        Cliquez sur les liens ci-dessous pour explorer le contexte environnemental de la zone s√©lectionn√©e :
      </p>
      <div class="results-grid" id="results-grid">
        <!-- Les cartes de r√©sultats seront ajout√©es ici dynamiquement -->
      </div>
    </div>
  </div>
</body>
</html>
